---
id: FnK2ws6w1uaS1YzBUY3BR
title: GitHub Pages with GitHub Actions
desc: ''
updated: 1647633491859
created: 1631306630307
---

## Summary

Publishing Dendron using [GitHub Actions](https://docs.github.com/en/actions), by using [GitHub Actions for GitHub Pages](https://github.com/peaceiris/actions-gh-pages).

## Why

GitHub Actions help provide an automated form of publishing where your notes are published whenever a new commit is made to the `main` branch of your GitHub repository.

The generated site is also written to the `pages` branch of your repository, which means that you don't need to continously make messy commits full of autogenerated files anymore. You won't need to version your published site files, or pull down to every system you use to write notes, since we only care about versioning the notes themselves.

## Prerequisites 

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.github#prerequisites,1:#*]]

## Example Deployment

Looking for an easy button?

You can see a deployed example of these instructions in the following repository, **which can be used as a template** (recommended):

- [Dendron on GitHub Pages with GitHub Actions Template: `template.publish.github-action`](https://github.com/dendronhq/template.publish.github-action)
  - The template, with every update, publishes to [this example website](https://dendronhq.github.io/template.publish.github-action/)

- NOTE: You'll need to change the `assetsPrefix` field in `dendron.yml` from `/template.publish.github-action` to your own prefix, unless you are planning to go with a [[Custom Domain Name|dendron://dendron.dendron-site/dendron.topic.publish.cook.github-action#custom-domain-names]].

## Create a GitHub repo

> The following directions assume you aren't using the example deployment template which can be autogenerated from the repository. If you are using the template, move forward to [[Process - Setup GitHub Pages|dendron://dendron.dendron-site/dendron.topic.publish.cook.github-action#process---setup-github-pages]].

Follow the instructions [here](https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-new-repository) to create a repository. GitHub Pages can publish both private and public repositories, leaving it up to you for the source code to be publicly available for viewing or contributions.

> This guide only covers how to work with public repositories and public GitHub Pages. If wanting to have private repositories configured for publishing, or for the published site to be private, visit the [GitHub Pages documentation for more information](https://docs.github.com/en/pages/getting-started-with-github-pages/about-github-pages#about-github-pages).

![[dendron.topic.publish.cook.github#add-your-notes:#turn-on-github-pages]]

## Steps - Setup Dendron

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.github#setup-dendron-nextjs-publishing,1:#publish-your-notes]]

## Steps - Setup GitHub Pages

1. Create a pages branch
  ```sh
  git checkout -b pages
  git push -u origin HEAD
  ```
1. Turn on GitHub Actions for the pages branch
  - Follow the [Choosing a publishing source](https://docs.github.com/en/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site) GitHub documentation with:
    - `pages` branch
    - `/ (root)` folder

## Steps - Setup GitHub Actions

1. Switch back to your main branch
  ```sh
  git checkout main
  ```
1. Create a workflow
  - mac and linux
    ```sh
    mkdir -p .github/workflows
    touch .github/workflows/publish.yml
    ```
  - windows
  ```powershell
  mkdir -p .github/workflows
  New-Item .github/workflows/publish.yml
  ```

1. Setup workflow
  ```yml
  name: Build Dendron Static Site

  on:
    push:
      branches:
      - main

  jobs:
    build:
      runs-on: ubuntu-latest
      steps:
      - name: Checkout source
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

      - name: Restore Node modules cache
        uses: actions/cache@v2
        id: node-modules-cache
        with:
          path: |
            node_modules
            .next/*
            !.next/.next/cache
            !.next/.env.*
          key: ${{ runner.os }}-dendronv2-${{ hashFiles('**/yarn.lock', '**/package-lock.json') }}

      - name: Install dependencies
        run: yarn

      - name: Restore Next cache
        uses: actions/cache@v2
        with:
          path: .next/.next/cache
          # Generate a new cache whenever packages or source files change.
          key: ${{ runner.os }}-nextjs-${{ hashFiles('.next/yarn.lock', '.next/package-lock.json') }}-${{ hashFiles('.next/**.[jt]s', '.next/**.[jt]sx') }}

      - name: Initialize or pull nextjs template
        run: "(test -d .next) && (echo 'updating dendron next...' && cd .next && git reset --hard && git clean -f && git pull && yarn && cd ..) || (echo 'init dendron next' && yarn dendron publish init)"

      - name: Export notes
        run: yarn dendron publish export --target github --yes

      - name: Deploy site
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: pages
          publish_dir: docs/
          force_orphan: true
          #cname: example.com
  ```

1. Commit your changes
  ```sh
  git add .
  git commit -m "add workflow"
  git push
  ```

## First Deployments

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.github#first-deployments,1:#*]]

## Custom Domain Names

If you are wanting to use your own domain name, follow the GitHub documentation [about custom domains and GitHub Pages](https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/about-custom-domains-and-github-pages). ^github-custom-domain-names

One requirement is to have a `CNAME` file in the root of your published docs, which the workflow file can automatically do for you.

The workflow YAML includes a commented out value, `cname`, at the very bottom of the configuration. You can uncomment this line, and use your own domain name as so.

```yaml
    - name: Deploy site
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_branch: pages
        publish_dir: docs/
        force_orphan: true
        cname: example.com
```

### siteUrl with Custom Domains

Also ensure that your `siteUrl` is adjusted properly in `dendron.yml`:

```yaml
publishing:
    siteUrl: https://example.com
```

- NOTE: When using custom domain names, `assetsPrefix` isn't required like it otherwise would be with GitHub Pages. Remove `assetsPrefix` if it is present in your `dendron.yml`, otherwise the website may not load as expected.

## Upgrading

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.common#upgrading,1:#*]]

## Congratulations, you just published your first note ðŸŒ±